FROM node:22-bookworm-slim

ENV NODE_ENV development
RUN apt update && apt install -y git curl sudo postgresql-client procps nano \
    && rm -rf /var/lib/apt/lists/*

# Give node user sudo access without password (for dev convenience)
RUN echo "node ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers.d/node

# Switch to node user
USER node

# expose port 3000 for application and 5555 for prisma studio
EXPOSE 3000 5555

ENV PORT 3000
ENTRYPOINT ["/workspaces/.devcontainer/init-cmd.sh"]
